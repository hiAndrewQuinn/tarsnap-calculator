<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tarsnap Cost Estimator</title>
    <style>
        @font-face{font-display:fallback;font-family:Noto Sans;font-style:normal;font-weight:400;src:local("Noto Sans"),local("NotoSans"),url(font/NotoSans-Regular-subset.woff2) format("woff2"),url(font/NotoSans-Regular-subset.woff) format("woff"),url(font/NotoSans-Regular-subset.ttf) format("truetype")}@font-face{font-display:fallback;font-family:Noto Sans;font-style:italic;font-weight:400;src:local("Noto Sans Italic"),local("NotoSans-Italic"),url(font/NotoSans-Italic-subset.woff2) format("woff2"),url(font/NotoSans-Italic-subset.woff) format("woff"),url(font/NotoSans-Italic-subset.ttf) format("truetype")}@font-face{font-display:fallback;font-family:Noto Sans;font-style:normal;font-weight:700;src:local("Noto Sans Bold"),local("NotoSans-Bold"),url(font/NotoSans-Bold-subset.woff2) format("woff2"),url(font/NotoSans-Bold-subset.woff) format("woff"),url(font/NotoSans-Bold-subset.ttf) format("truetype")}@font-face{font-display:fallback;font-family:"Noto Serif";font-style:normal;font-weight:700;src:local("Noto Serif Bold"),local("NotoSerif-Bold"),url(font/NotoSerif-Bold-subset.woff2) format("woff2"),url(font/NotoSerif-Bold-subset.woff) format("woff"),url(font/NotoSerif-Bold-subset.ttf) format("truetype")}@font-face{font-display:fallback;font-family:Noto Mono;src:local("Noto Mono"),local("NotoMono"),url(font/NotoMono-Regular-subset.woff2) format("woff2"),url(font/NotoMono-Regular-subset.woff) format("woff"),url(font/NotoMono-Regular-subset.ttf) format("truetype")}article,aside,figure,footer,header,main,nav,section{display:block}div.nonbanner{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}div.leftmargin{-webkit-box-flex:1;-webkit-flex:1 0 10em;-moz-box-flex:1;-ms-flex:1 0 10em;flex:1 0 10em;-webkit-box-ordinal-group:2;-webkit-order:1;-moz-box-ordinal-group:2;-ms-flex-order:1;margin-bottom:1.5em;order:1}main{-webkit-box-ordinal-group:3;-webkit-order:2;-moz-box-ordinal-group:3;-ms-flex-order:2;order:2;-webkit-box-flex:1000;-webkit-flex:1000 0 16em;-moz-box-flex:1000;-ms-flex:1000 0 16em;flex:1000 0 16em;padding-left:.75em;padding-right:.75em}nav ul{list-style-type:none;margin:0;padding-left:0}nav ul ul{padding-left:1em}nav li{display:inline}nav a{background:#cfe7ff;border:2px solid #cfe7ff;color:#000;display:block;font-family:Noto Sans,sans-serif;font-size:80%;margin-bottom:.25em;padding:.25em;-webkit-text-decoration:none;text-decoration:none}nav a.current{background:#9fcfff;border-color:#9fcfff}nav a:hover{border-color:#000}nav>ul>li:first-child>a{-webkit-border-radius:.5em .5em 0 0;border-radius:.5em .5em 0 0}nav>ul>li:last-child>a{-webkit-border-radius:0 0 .5em .5em;border-radius:0 0 .5em .5em}div.onecol,div.twocol{-webkit-box-flex:0;-webkit-flex:0 0 100%;-moz-box-flex:0;-ms-flex:0 0 100%;flex:0 0 100%}div.twocol{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}div.column{-webkit-box-flex:1;-webkit-flex:1 0 16em;-moz-box-flex:1;-ms-flex:1 0 16em;flex:1 0 16em;min-width:16em}div.expand-vertical{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}section{-webkit-box-flex:1;-webkit-flex:1 0 auto;-moz-box-flex:1;background:#fafafa;border:1px solid #fff;-webkit-border-radius:2em 2em 1em 1em;border-radius:2em 2em 1em 1em;-ms-flex:1 0 auto;flex:1 0 auto;margin:0 .75em 1.5em}ul.justified li{margin-bottom:1em;text-align:justify}section h3{border-bottom:1px solid #ccc;border-left-width:0;-webkit-border-radius:1em 1em 0 0;border-radius:1em 1em 0 0;border-right-width:0;border-top-width:0;font-family:"Noto Serif",serif;font-size:1.2em;font-weight:700;margin:0;padding:.5em;text-align:center}section h3{background:#fcfcb0}section h3.doc{background:#dfdfff}section h3.attention{background:#ffbfbf}div.boxcontents{font-family:Noto Sans,sans-serif;margin-bottom:.5em;padding-left:1em;padding-right:1em}div.boxcontents p{text-align:justify}div.no-justify p{text-align:left}div.boxcontents h4{margin-bottom:.8em;margin-top:1.6em}div.boxcontents h4:first-child{margin-top:.8em}p.error{color:red}pre{margin:.25em 0 .25em 1em;white-space:pre-wrap}.nowrap{white-space:nowrap}var{color:#141;font-family:Noto Mono,monospace;font-size:.75em;font-style:normal}code var,pre var{font-size:100%}pre.command:before{content:"$ ";font-style:normal}pre.command-su:before{content:"# ";font-style:normal}li pre{margin:.25em 0 .25em 1em}ul.compact-list{margin:0;padding-left:1.25em}div.contain-float{overflow:hidden}table.normal{border-collapse:collapse;border-spacing:0;margin-bottom:1em}table.normal td,table.normal th{padding:.125em}table.normal table,table.normal td,table.normal th{border:.125em solid #666}table.hash td code{word-break:break-all}table.outages td,table.outages th{padding:.25em .5em;text-align:center}a.footnote{-webkit-text-decoration:none;text-decoration:none}span.date{font-family:Noto Mono,monospace;white-space:nowrap}table.normal-padded{margin:.5em 2em}table.normal-padded td{padding:.125em .25em}code,pre{font-family:Noto Mono,monospace;font-size:.75em}header img{max-width:100%}table.pricing{border:none;margin:auto;padding:0 .5em .125em}table.pricing th{color:#141;font-weight:700;text-align:right;vertical-align:top}td.account{text-align:right}dl.examples dt{margin-top:.5em}div.testimonial{margin-top:1em;overflow:hidden}div.testimonial-text{font-style:italic;padding-right:.5em;text-align:justify}div.testimonial-person{text-align:right}div.testimonial-image{float:right;padding-left:.75em}div.size{display:table;table-layout:fixed;width:100%}pre.size{overflow-x:auto;white-space:pre}div.center{text-align:center}aside,em{font-style:italic}aside{border-left:.01em solid #ccc;color:#444;margin:.5em 0 1em 2em;padding-left:.5em}aside.narrow{margin-left:.5em}aside.nobar{border-left:0}p+aside,ul+aside{margin-top:-.75em}li>ul+aside{margin-top:0}aside ul{margin:0}aside pre{font-style:normal;margin:.25em 0 .25em 1em}div.attention{background:#ffc6c6;font-weight:700}div.attention,div.attention-mild{border:1px solid #ccc;display:inline-block;margin:.25em;padding:.25em}div.attention-mild{background:#fff3f3;text-align:left}div.sudo-container{-webkit-box-flex:0;-webkit-flex:0 0 100%;-moz-box-flex:0;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-ms-flex:0 0 100%;flex:0 0 100%;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;overflow:hidden;padding:.5em 0 .5em .5em}div.sudo-box{background:#f3f3fa;border-left:1px solid #ccc;border-right:1px solid #ccc;min-width:19em}div.sudo-box h5{background:#dfdfff;font-size:100%;font-weight:400;margin:0;padding:.25em .5em}div.sudo-box pre.command,div.sudo-box pre.command-su{margin:.25em}div.boxcontents div.note{background:#f3f3fa;border:1px solid #ccc;margin:1em}div.boxcontents div.note h4{background:#dfdfff;margin-top:0;padding:.25em}div.boxcontents div.note h4.attention{background:#ffbfbf}summary{background:#fafafa;color:#844;padding:.125em .5em .5em .25em}details{background:#fff3f3}details div.boxcontents{padding-bottom:.25em;padding-top:.25em}span.problem{font-weight:700;margin:.5em .5em .5em 0}img.image-overview{float:right;margin:1em 0 1em 1em;max-width:100%;min-width:12em}ul.column-min-width:before{content:"";display:block;overflow:hidden;width:12em}img.image-spiped{display:block;margin-left:auto;margin-right:auto;margin-top:1em;max-width:100%;min-width:12em}div.boxcontents div.button{font-weight:700;margin-top:1.5em;padding-bottom:.8em}a.register-button{background:#cfc;border:1px solid #beb;-webkit-border-radius:.75em;border-radius:.75em;-webkit-box-shadow:.2em .2em .2em #ccc;box-shadow:.2em .2em .2em #ccc;color:#222;padding:.5em;-webkit-text-decoration:none;text-decoration:none}a.register-button:hover{background:#dfffdf}b,strong{font-family:Noto Sans;font-weight:700}strong.main{color:#141}img.kivaloo{max-width:100%}div.table-container{overflow-x:auto;width:100%}table.de-table{border-collapse:collapse;margin:auto auto 1em;max-width:50em;width:90%}table.de-table td{padding:.5em}table.de-table col.de-col,table.de-table td:first-child,table.de-table td:first-child+td+td,table.de-table td:first-child+td+td+td+td,table.de-table td:first-child+td+td+td+td+td{border:1px solid grey}table.de-table col.de-table-spacer{width:5%}.de-table-local{background-color:#ffffe6}.de-table-transfer{background-color:#f2fff2}.de-table-server{background-color:#eaffff}span.arrow-space{padding-left:.75em;padding-right:.75em}span.de-archive{color:blue}span.de-word{color:orange}span.de-text{color:purple}span.de-text,span.encoded{font-family:Noto Mono,monospace;font-size:.9em}.apt-modern{background-color:#dafada}.apt-old{background-color:#fafada}@media (max-width:50em){div.twocol{display:block}}@media (max-width:34em){div.leftmargin{-webkit-box-ordinal-group:4;-webkit-order:3;-moz-box-ordinal-group:4;-ms-flex-order:3;order:3;-webkit-box-flex:0;-webkit-flex:0 0 100%;-moz-box-flex:0;-ms-flex:0 0 100%;flex:0 0 100%}nav a{font-size:1.25em;margin-bottom:.5em;padding:.5em}div.nonbanner{display:block}article{padding:0}section{margin:0 0 1.5em}div.boxcontents{padding-left:.5em;padding-right:.5em}div.boxcontents ol,div.boxcontents ul{padding-left:1.5em}div.boxcontents aside{margin-left:1em}div.boxcontents div.sudo-container{padding:.5em 0}div.boxcontents table.normal{margin:.5em}}

        /* Custom styles for calculator elements */
        body { background: #eee; }
        main { background: #fff; padding-bottom: 2em; }
        h1 { font-family: "Noto Serif", serif; color: #000; border-bottom: 1px solid #ccc; padding-bottom: .5em; text-align: center;}
        input[type="number"] { font-family: Noto Mono, monospace; padding: .25em; font-size: 1.1em; max-width: 250px; margin-left: 1em; }
        .results-list { list-style-type: none; padding-left: 0; margin-top: 1.5em; }
        .results-list li { display: flex; justify-content: space-between; padding: .5em; border-bottom: 1px dotted #ccc; }
        .results-list li:nth-child(2n) { background: #fafafa; }
        .results-list strong { font-family: Noto Mono, monospace; color: #141; }
        .longevity-result { text-align: center; font-size: 1.2em; color: #141; background: #fcfcb0; padding: 1rem; border-radius: 4px; margin-top: 1rem; }
        table.normal th { text-align: left; }
    </style>
</head>
<body>
    <div class="nonbanner">
        <main>
            <h1><a href="https://www.tarsnas.com/utility.html">Tarsnap</a> Cost Estimator</h1>
            <p style="text-align: center;">
            This tool estimates <a href="https://www.tarsnap.com/">Tarsnap</a> backup costs based on the official pricing model: 250 picodollars per byte-month for storage and 250 picodollars per byte for bandwidth. All calculations use the SI definition where 1 Gigabyte (GB) = 10<sup>9</sup> bytes.
            </p>

            <p style="text-align: center;">N.B., these are <em>rough estimates</em> provided without any guarantee of perfect accuracy. In particular, if we wanted to be truly accurate, we would actually <a href="https://www.tarsnap.com/picoUSD-why.html">calculate prices in attodollar-days based on how many days the month has</a>, and that would require you, dear reader, to put in what today's date was, etc., ... it would be a mess. So <strong>caveat emptor</strong>, even though Dr. Percival's pricing really is quite elegant.</p>
            <p style="text-align: center;">(<a href="https://github.com/hiAndrewQuinn/tarsnap-calculator">This humble calculator</a> is not associated with Tarsnap or its creator in any way. Just a fan!)</p>
            <section>
                <h3>Custom Amount Calculator</h3>
                <div class="boxcontents">
                    <p class="no-justify">Enter the <strong>exact amount</strong> of <em>unique</em> encoded data in bytes to see your estimated costs. <a href="https://www.tarsnap.com/GB-why.html">1,000,000,000 bytes, our starting value, is 1 GB</a> in the tarsnap model; in many other places 1 GB means something slightly larger, at 2^30 = 1,073,741,824 bytes.</p>
                    <div>
                        <label for="dataAmount"><strong>Encoded Data Amount:</strong></label>
                        <input type="number" id="dataAmount" value="1000000000" min="0">
                        <var>bytes</var>
                    </div>
                    <div id="custom-results">
                        </div>
                </div>
            </section>

            <section>
                <h3 class="doc">Standard Unit Cost Reference</h3>
                <div class="boxcontents">
                    <p class="no-justify">This table shows the recurring storage costs for standard SI (decimal) units.</p>
                    <div class="table-container">
                        <table class="normal" style="width: 100%;">
                            <thead>
                                <tr>
                                    <th>Unit Name</th>
                                    <th>SI Multiplier (bytes)</th>
                                    <th>Cost per Month</th>
                                    <th>Cost per Year</th>
                                </tr>
                            </thead>
                            <tbody id="reference-table-body">
                                </tbody>
                        </table>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const amountInput = document.getElementById('dataAmount');
            const customResultsDiv = document.getElementById('custom-results');
            const referenceTableBody = document.getElementById('reference-table-body');

            // --- Constants ---
            const PICODOLLARS_PER_DOLLAR = 1e12;
            const COST_PER_BYTE_PICODOLLARS = 250;
            const COST_PER_BYTE_IN_DOLLARS = COST_PER_BYTE_PICODOLLARS / PICODOLLARS_PER_DOLLAR;

            const AVG_DAYS_PER_MONTH = 365.25 / 12;

            const formatCurrency = (value) => {
                if (value === 0) return '$0.00';
                if (value > 0 && value < 0.0001) {
                    return `$${value.toExponential(3)}`;
                }
                return value.toLocaleString('en-US', {
                    style: 'currency',
                    currency: 'USD',
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 4
                });
            };
            
            const formatNumber = (num) => {
                 if (num < 1000) return num.toString();
                 return num.toExponential(2);
            };

            const calculateAndDisplayCustom = () => {
                const totalBytes = parseFloat(amountInput.value);

                if (isNaN(totalBytes) || totalBytes < 0) {
                    customResultsDiv.innerHTML = "<p class='error'>Please enter a valid number of bytes.</p>";
                    return;
                }

                // Calculations
                const bandwidthCost = totalBytes * COST_PER_BYTE_IN_DOLLARS;
                const costPerMonth = totalBytes * COST_PER_BYTE_IN_DOLLARS;
                const costPerDay = costPerMonth / AVG_DAYS_PER_MONTH;
                const costPerWeek = costPerDay * 7;
                const costPerYear = costPerMonth * 12;
                const costPerDecade = costPerYear * 10;

                let longevityString = "Effectively forever";
                if (costPerMonth > 0) {
                    const monthsFor100 = 100 / costPerMonth;
                    const years = Math.floor(monthsFor100 / 12);
                    const remainingMonths = Math.round(monthsFor100 % 12);
                    longevityString = `~ ${years.toLocaleString()} years and ${remainingMonths} months`;
                }

                customResultsDiv.innerHTML = `
                    <h4 style="text-align:center;">Results for ${totalBytes.toLocaleString()} bytes</h4>
                    <ul class="results-list">
                        <li><span>One-time bandwidth cost to upload:</span> <strong>${formatCurrency(bandwidthCost)}</strong></li>
                        <li><span>Storage Cost per Day (varies slightly by month):</span> <strong>${formatCurrency(costPerDay)}</strong></li>
                        <li><span>Storage Cost per Week (varies slightly by month):</span> <strong>${formatCurrency(costPerWeek)}</strong></li>
                        <li><span>Storage Cost per Month:</span> <strong>${formatCurrency(costPerMonth)}</strong></li>
                        <li><span>Storage Cost per Year:</span> <strong>${formatCurrency(costPerYear)}</strong></li>
                        <li><span>Storage Cost per Decade:</span> <strong>${formatCurrency(costPerDecade)}</strong></li>
                    </ul>
                    <h4>How long would $100 last for this upload?</h4>
                    <div class="longevity-result">${longevityString}</div>
                    <p class="no-justify">This price estimate assumes you upload the data just once, and then never touch it again. Still, hopefully it serves as a useful rough lower bound.</p>

                `;
            };

            const populateReferenceTable = () => {
                const units = [
                    { name: 'Gigabyte (GB)', bytes: 1e9 },
                    { name: 'Terabyte (TB)', bytes: 1e12 },
                    { name: 'Petabyte (PB)', bytes: 1e15 }
                ];

                let tableHTML = '';
                units.forEach(unit => {
                    const costPerMonth = unit.bytes * COST_PER_BYTE_IN_DOLLARS;
                    const costPerYear = costPerMonth * 12;
                    tableHTML += `
                        <tr>
                            <td>${unit.name}</td>
                            <td><code>10<sup>${Math.log10(unit.bytes)}</sup></code></td>
                            <td>${formatCurrency(costPerMonth)}</td>
                            <td>${formatCurrency(costPerYear)}</td>
                        </tr>
                    `;
                });
                referenceTableBody.innerHTML = tableHTML;
            };

            // Event listener to trigger recalculation
            amountInput.addEventListener('input', calculateAndDisplayCustom);

            // Initial calculations on page load
            calculateAndDisplayCustom();
            populateReferenceTable();
        });
    </script>
</body>
</html>
